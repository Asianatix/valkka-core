<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Valkka: FrameFifo Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Valkka
   &#160;<span id="projectnumber">0.3.0</span>
   </div>
   <div id="projectbrief">Massive Video Streaming for Linux</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classFrameFifo-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FrameFifo Class Reference<div class="ingroups"><a class="el" href="group__queues__tag.html">queues and fifos</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A thread-safe <a class="el" href="classFrameFifo.html" title="A thread-safe FrameFifo (first-in-first-out) queue with thread-safe methods for inserting and popping...">FrameFifo</a> (first-in-first-out) queue with thread-safe methods for inserting and popping frames in/from the queue.  
 <a href="classFrameFifo.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="queues_8h_source.html">queues.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FrameFifo:</div>
<div class="dyncontent">
<div class="center"><img src="classFrameFifo__inherit__graph.png" border="0" usemap="#FrameFifo_inherit__map" alt="Inheritance graph"/></div>
<map name="FrameFifo_inherit__map" id="FrameFifo_inherit__map">
<area shape="rect" id="node2" href="classLiveFifo.html" title="This is a special FrameFifo class for feeding frames into live555, i.e. " alt="" coords="5,80,73,107"/>
<area shape="rect" id="node3" href="classOpenGLFrameFifo.html" title="A FrameFifo with multiple stacks. " alt="" coords="97,80,227,107"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab66a2d4512d5cb7701f79d8e3af6ebb6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ab66a2d4512d5cb7701f79d8e3af6ebb6">FrameFifo</a> (const char *<a class="el" href="classFrameFifo.html#a773560493e8d226f2b0c2b4e31ad8505">name</a>, unsigned short int <a class="el" href="classFrameFifo.html#ae0ae5c0c72de6d1a2611e7af75db1be3">n_stack</a>, bool <a class="el" href="classFrameFifo.html#ab4a0c5d710e7a164bd87c5afe569a084">clear_when_filled</a>=false)</td></tr>
<tr class="memdesc:ab66a2d4512d5cb7701f79d8e3af6ebb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#ab66a2d4512d5cb7701f79d8e3af6ebb6">More...</a><br /></td></tr>
<tr class="separator:ab66a2d4512d5cb7701f79d8e3af6ebb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85de58431db509135505e7956a0715e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa85de58431db509135505e7956a0715e"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#aa85de58431db509135505e7956a0715e">~FrameFifo</a> ()</td></tr>
<tr class="memdesc:aa85de58431db509135505e7956a0715e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default virtual destructor. <br /></td></tr>
<tr class="separator:aa85de58431db509135505e7956a0715e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d9dbc000f3f2e57ff80faeba3cb10df"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7d9dbc000f3f2e57ff80faeba3cb10df"></a>
virtual <a class="el" href="classFrame.html">Frame</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a7d9dbc000f3f2e57ff80faeba3cb10df">getFrame</a> ()</td></tr>
<tr class="memdesc:a7d9dbc000f3f2e57ff80faeba3cb10df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take a frame from the stack. <br /></td></tr>
<tr class="separator:a7d9dbc000f3f2e57ff80faeba3cb10df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01765bd79b616a2425ba84d94a15d737"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a01765bd79b616a2425ba84d94a15d737">writeCopy</a> (<a class="el" href="classFrame.html">Frame</a> *f, bool wait=false)</td></tr>
<tr class="memdesc:a01765bd79b616a2425ba84d94a15d737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take a frame "ftmp" from the stack, copy contents of "f" into "ftmp" and insert "ftmp" into the beginning of the fifo (i.e. perform "copy-on-insert"). The size of "ftmp" is also checked and set to target_size, if necessary. If wait is set to true, will wait until there are frames available in the stack.  <a href="#a01765bd79b616a2425ba84d94a15d737">More...</a><br /></td></tr>
<tr class="separator:a01765bd79b616a2425ba84d94a15d737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae984545cb5d40a1d0fe8b8e369d9c64"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classFrame.html">Frame</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#aae984545cb5d40a1d0fe8b8e369d9c64">read</a> (unsigned short int mstimeout=0)</td></tr>
<tr class="memdesc:aae984545cb5d40a1d0fe8b8e369d9c64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pop a frame from the end of the fifo and return the frame to the reservoir stack.  <a href="#aae984545cb5d40a1d0fe8b8e369d9c64">More...</a><br /></td></tr>
<tr class="separator:aae984545cb5d40a1d0fe8b8e369d9c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09f514fe06c5e737cd74691f8b5d9d52"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a09f514fe06c5e737cd74691f8b5d9d52"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a09f514fe06c5e737cd74691f8b5d9d52">recycle</a> (<a class="el" href="classFrame.html">Frame</a> *f)</td></tr>
<tr class="memdesc:a09f514fe06c5e737cd74691f8b5d9d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return <a class="el" href="classFrame.html" title="A universal frame class encapsulating all media formats. ">Frame</a> f back into the stack. Update target_size if necessary. <br /></td></tr>
<tr class="separator:a09f514fe06c5e737cd74691f8b5d9d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a094d025e259aef84c8d3d4b76c0076eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a094d025e259aef84c8d3d4b76c0076eb"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a094d025e259aef84c8d3d4b76c0076eb">recycleAll</a> ()</td></tr>
<tr class="memdesc:a094d025e259aef84c8d3d4b76c0076eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recycle all frames from fifo back to stack (make a "flush") <br /></td></tr>
<tr class="separator:a094d025e259aef84c8d3d4b76c0076eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6b1aca3db868d937039a9f066e8f0ca"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af6b1aca3db868d937039a9f066e8f0ca"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#af6b1aca3db868d937039a9f066e8f0ca">dumpStack</a> ()</td></tr>
<tr class="memdesc:af6b1aca3db868d937039a9f066e8f0ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the frames in the stack. <br /></td></tr>
<tr class="separator:af6b1aca3db868d937039a9f066e8f0ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbff47ed40f017d26d8a905f7decc9e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afbff47ed40f017d26d8a905f7decc9e1"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#afbff47ed40f017d26d8a905f7decc9e1">dumpFifo</a> ()</td></tr>
<tr class="memdesc:afbff47ed40f017d26d8a905f7decc9e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump frames in the fifo. <br /></td></tr>
<tr class="separator:afbff47ed40f017d26d8a905f7decc9e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a956716c1cc2162314b7f305a8c4ca9e4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a956716c1cc2162314b7f305a8c4ca9e4"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a956716c1cc2162314b7f305a8c4ca9e4">diagnosis</a> ()</td></tr>
<tr class="memdesc:a956716c1cc2162314b7f305a8c4ca9e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a resumen of fifo and stack usage. <br /></td></tr>
<tr class="separator:a956716c1cc2162314b7f305a8c4ca9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e3264d8b8f8a787cd305c79e568645"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a37e3264d8b8f8a787cd305c79e568645"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a37e3264d8b8f8a787cd305c79e568645">isEmpty</a> ()</td></tr>
<tr class="memdesc:a37e3264d8b8f8a787cd305c79e568645"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell if fifo is empty. <br /></td></tr>
<tr class="separator:a37e3264d8b8f8a787cd305c79e568645"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab4b94214b0550056605bc05f28a8d488"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4b94214b0550056605bc05f28a8d488"></a>
std::deque&lt; <a class="el" href="classFrame.html">Frame</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ab4b94214b0550056605bc05f28a8d488">stack</a></td></tr>
<tr class="memdesc:ab4b94214b0550056605bc05f28a8d488"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reservoir of frames. We could have several reservoirs, i.e. for different frame sizes, etc. <br /></td></tr>
<tr class="separator:ab4b94214b0550056605bc05f28a8d488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab306eb3027b1b626b30522a49b833cbb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab306eb3027b1b626b30522a49b833cbb"></a>
std::deque&lt; <a class="el" href="classFrame.html">Frame</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ab306eb3027b1b626b30522a49b833cbb">fifo</a></td></tr>
<tr class="memdesc:ab306eb3027b1b626b30522a49b833cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual fifo. <br /></td></tr>
<tr class="separator:ab306eb3027b1b626b30522a49b833cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a20291fd4dc516ce1d0c6db865468a483"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20291fd4dc516ce1d0c6db865468a483"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>initReservoir</b> (std::vector&lt; <a class="el" href="classFrame.html">Frame</a> &gt; &amp;<a class="el" href="classFrameFifo.html#a1dcdf53fced8660fbebf04e07c7bc477">reservoir</a>, unsigned short <a class="el" href="classFrameFifo.html#ae0ae5c0c72de6d1a2611e7af75db1be3">n_stack</a>)</td></tr>
<tr class="separator:a20291fd4dc516ce1d0c6db865468a483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9b0bc7d0267a11328656c59beb8cc2f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae9b0bc7d0267a11328656c59beb8cc2f"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>initPayload</b> (std::vector&lt; <a class="el" href="classFrame.html">Frame</a> &gt; &amp;<a class="el" href="classFrameFifo.html#a1dcdf53fced8660fbebf04e07c7bc477">reservoir</a>)</td></tr>
<tr class="separator:ae9b0bc7d0267a11328656c59beb8cc2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d0bb241548ec8da902ee3aad39fb5a7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1d0bb241548ec8da902ee3aad39fb5a7"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>initStack</b> (std::vector&lt; <a class="el" href="classFrame.html">Frame</a> &gt; &amp;<a class="el" href="classFrameFifo.html#a1dcdf53fced8660fbebf04e07c7bc477">reservoir</a>, std::deque&lt; <a class="el" href="classFrame.html">Frame</a> * &gt; &amp;<a class="el" href="classFrameFifo.html#ab4b94214b0550056605bc05f28a8d488">stack</a>)</td></tr>
<tr class="separator:a1d0bb241548ec8da902ee3aad39fb5a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad86f9d5aeee6b6b068dd06fea0fd07d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad86f9d5aeee6b6b068dd06fea0fd07d8"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>dump</b> (std::deque&lt; <a class="el" href="classFrame.html">Frame</a> * &gt; &amp;queue)</td></tr>
<tr class="separator:ad86f9d5aeee6b6b068dd06fea0fd07d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a773560493e8d226f2b0c2b4e31ad8505"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a773560493e8d226f2b0c2b4e31ad8505"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a773560493e8d226f2b0c2b4e31ad8505">name</a></td></tr>
<tr class="memdesc:a773560493e8d226f2b0c2b4e31ad8505"><td class="mdescLeft">&#160;</td><td class="mdescRight">A unique name identifying this fifo. <br /></td></tr>
<tr class="separator:a773560493e8d226f2b0c2b4e31ad8505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ae5c0c72de6d1a2611e7af75db1be3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae0ae5c0c72de6d1a2611e7af75db1be3"></a>
unsigned short int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ae0ae5c0c72de6d1a2611e7af75db1be3">n_stack</a></td></tr>
<tr class="memdesc:ae0ae5c0c72de6d1a2611e7af75db1be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max number of frames in the fifo. <br /></td></tr>
<tr class="separator:ae0ae5c0c72de6d1a2611e7af75db1be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4a0c5d710e7a164bd87c5afe569a084"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4a0c5d710e7a164bd87c5afe569a084"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ab4a0c5d710e7a164bd87c5afe569a084">clear_when_filled</a></td></tr>
<tr class="memdesc:ab4a0c5d710e7a164bd87c5afe569a084"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recycle all frames from fifo to stack is running empty. <br /></td></tr>
<tr class="separator:ab4a0c5d710e7a164bd87c5afe569a084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937f07e8345eeced5fcb2447e4c234ea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a937f07e8345eeced5fcb2447e4c234ea"></a>
std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a937f07e8345eeced5fcb2447e4c234ea">mutex</a></td></tr>
<tr class="memdesc:a937f07e8345eeced5fcb2447e4c234ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Lock. <br /></td></tr>
<tr class="separator:a937f07e8345eeced5fcb2447e4c234ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc5c9566659c291a242420e2b4ea32d9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acc5c9566659c291a242420e2b4ea32d9"></a>
std::condition_variable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#acc5c9566659c291a242420e2b4ea32d9">condition</a></td></tr>
<tr class="memdesc:acc5c9566659c291a242420e2b4ea32d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Event/Flag. <br /></td></tr>
<tr class="separator:acc5c9566659c291a242420e2b4ea32d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d80e7d932d903e92a9359ebea73992e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5d80e7d932d903e92a9359ebea73992e"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a5d80e7d932d903e92a9359ebea73992e">count</a> = 0</td></tr>
<tr class="memdesc:a5d80e7d932d903e92a9359ebea73992e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Semaphore counter: number of frames available for the consumer. <br /></td></tr>
<tr class="separator:a5d80e7d932d903e92a9359ebea73992e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcdf53fced8660fbebf04e07c7bc477"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1dcdf53fced8660fbebf04e07c7bc477"></a>
std::vector&lt; <a class="el" href="classFrame.html">Frame</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a1dcdf53fced8660fbebf04e07c7bc477">reservoir</a></td></tr>
<tr class="memdesc:a1dcdf53fced8660fbebf04e07c7bc477"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre-allocated frames are warehoused in this reservoir. <br /></td></tr>
<tr class="separator:a1dcdf53fced8660fbebf04e07c7bc477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab46357a7162ee6151a01ae1898b88c31"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab46357a7162ee6151a01ae1898b88c31"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ab46357a7162ee6151a01ae1898b88c31">target_size</a> = 0</td></tr>
<tr class="memdesc:ab46357a7162ee6151a01ae1898b88c31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum frame payload size. <br /></td></tr>
<tr class="separator:ab46357a7162ee6151a01ae1898b88c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ac5484703b4a71fd71f0182c8554c6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a10ac5484703b4a71fd71f0182c8554c6"></a>
std::condition_variable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a10ac5484703b4a71fd71f0182c8554c6">ready_condition</a></td></tr>
<tr class="memdesc:a10ac5484703b4a71fd71f0182c8554c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Event/Flag for FrameFifo::ready_mutex. <br /></td></tr>
<tr class="separator:a10ac5484703b4a71fd71f0182c8554c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae5f547e4abad8f5bc1322d452418bfdd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#ae5f547e4abad8f5bc1322d452418bfdd">FrameFifo</a> (const <a class="el" href="classFrameFifo.html">FrameFifo</a> &amp;)</td></tr>
<tr class="memdesc:ae5f547e4abad8f5bc1322d452418bfdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Void copy-constructor: this class is non-copyable.  <a href="#ae5f547e4abad8f5bc1322d452418bfdd">More...</a><br /></td></tr>
<tr class="separator:ae5f547e4abad8f5bc1322d452418bfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5780fdd2c833e32df4cd69b4174f1aea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5780fdd2c833e32df4cd69b4174f1aea"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFrameFifo.html#a5780fdd2c833e32df4cd69b4174f1aea">operator=</a> (const <a class="el" href="classFrameFifo.html">FrameFifo</a> &amp;)</td></tr>
<tr class="memdesc:a5780fdd2c833e32df4cd69b4174f1aea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Void copy-constructor: this class is non-copyable. <br /></td></tr>
<tr class="separator:a5780fdd2c833e32df4cd69b4174f1aea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A thread-safe <a class="el" href="classFrameFifo.html" title="A thread-safe FrameFifo (first-in-first-out) queue with thread-safe methods for inserting and popping...">FrameFifo</a> (first-in-first-out) queue with thread-safe methods for inserting and popping frames in/from the queue. </p>
<p><a class="el" href="classFrameFifo.html" title="A thread-safe FrameFifo (first-in-first-out) queue with thread-safe methods for inserting and popping...">FrameFifo</a> also implements an internal semaphore. For this, we need three things:</p>
<ul>
<li>an event (i.e. flag). In cpp these are called "condition variables" (<a class="el" href="classFrameFifo.html#acc5c9566659c291a242420e2b4ea32d9" title="The Event/Flag. ">FrameFifo::condition</a>)</li>
<li>a lock (<a class="el" href="classFrameFifo.html#a937f07e8345eeced5fcb2447e4c234ea" title="The Lock. ">FrameFifo::mutex</a>)</li>
<li>a counter (<a class="el" href="classFrameFifo.html#a5d80e7d932d903e92a9359ebea73992e" title="Semaphore counter: number of frames available for the consumer. ">FrameFifo::count</a>)</li>
</ul>
<p>Condition variable signals when there is a state change. Lock protects inspection/manipulation of the semaphore counter.</p>
<p>Frames used in the fifo originate from an internal stack reservoir. Once the frame is removed ("popped") from the right end of the queue, it is returned ("recycled") back to the reservoir. The process cycle is as follows:</p>
<ul>
<li>Take a <a class="el" href="classFrame.html" title="A universal frame class encapsulating all media formats. ">Frame</a> (let's call it "tmpframe") from the pre-allocated reservoir <a class="el" href="classFrameFifo.html#ab4b94214b0550056605bc05f28a8d488" title="Reservoir of frames. We could have several reservoirs, i.e. for different frame sizes, etc. ">FrameFifo.stack</a></li>
<li>Do something with <a class="el" href="classFrame.html" title="A universal frame class encapsulating all media formats. ">Frame</a> "tmpframe" (e.g. insert data to <a class="el" href="classFrame.html#a93b131179e6402e7af5e75cd0cc0044a" title="Raw payload data (use .data() to get the pointer from std::vector) ">Frame.payload</a>)</li>
<li>Insert <a class="el" href="classFrame.html" title="A universal frame class encapsulating all media formats. ">Frame</a> into the fifo (i.e. into <a class="el" href="classFrameFifo.html#ab306eb3027b1b626b30522a49b833cbb" title="The actual fifo. ">FrameFifo.fifo</a>) from the left</li>
<li>Another thread takes the frame from the right-side of <a class="el" href="classFrameFifo.html#ab306eb3027b1b626b30522a49b833cbb" title="The actual fifo. ">FrameFifo.fifo</a>, and does something with it (most likely creates a copy) and finally returns ("recycles") it back to <a class="el" href="classFrameFifo.html#ab4b94214b0550056605bc05f28a8d488" title="Reservoir of frames. We could have several reservoirs, i.e. for different frame sizes, etc. ">FrameFifo.stack</a></li>
</ul>
<p>These steps are implemented in <a class="el" href="classFrameFifo.html#a01765bd79b616a2425ba84d94a15d737" title="Take a frame &quot;ftmp&quot; from the stack, copy contents of &quot;f&quot; into &quot;ftmp&quot; and insert &quot;ftmp&quot; into the begin...">FrameFifo::writeCopy</a> and <a class="el" href="classFrameFifo.html#a09f514fe06c5e737cd74691f8b5d9d52" title="Return Frame f back into the stack. Update target_size if necessary. ">FrameFifo::recycle</a></p>
<p><a class="el" href="classFrameFifo.html#a09f514fe06c5e737cd74691f8b5d9d52" title="Return Frame f back into the stack. Update target_size if necessary. ">FrameFifo::recycle</a> also checks the payload size of the "recycled" frame (this may have been modified by the user) and augments <a class="el" href="classFrameFifo.html#ab46357a7162ee6151a01ae1898b88c31" title="Minimum frame payload size. ">FrameFifo.target_size</a> accordingly. On consecutive calls to <a class="el" href="classFrameFifo.html#a01765bd79b616a2425ba84d94a15d737" title="Take a frame &quot;ftmp&quot; from the stack, copy contents of &quot;f&quot; into &quot;ftmp&quot; and insert &quot;ftmp&quot; into the begin...">FrameFifo::writeCopy</a>, the frames in the stack are conformed to this payload size </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab66a2d4512d5cb7701f79d8e3af6ebb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FrameFifo::FrameFifo </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>n_stack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear_when_filled</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name identifying this fifo </td></tr>
    <tr><td class="paramname">n_stack</td><td>Size of the frame reservoir </td></tr>
    <tr><td class="paramname">clear_when_filled</td><td>What to do when all frames in the reservoir are used? If set to true, all frames are immediately removed from the fifo (a "flush") and recycled back to the stack. Default=false. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae5f547e4abad8f5bc1322d452418bfdd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FrameFifo::FrameFifo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFrameFifo.html">FrameFifo</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Void copy-constructor: this class is non-copyable. </p>
<p>We have a mutex member in this class. Those are non-copyable. Other possibility would be to manage a pointer to the mutex. The "pointerization" can be done at some other level as well (say, using pointers of this object) </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aae984545cb5d40a1d0fe8b8e369d9c64"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFrame.html">Frame</a> * FrameFifo::read </td>
          <td>(</td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>mstimeout</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pop a frame from the end of the fifo and return the frame to the reservoir stack. </p>
<p>this-&gt;ready_condition.notify_one(); </p>

</div>
</div>
<a class="anchor" id="a01765bd79b616a2425ba84d94a15d737"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FrameFifo::writeCopy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFrame.html">Frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wait</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Take a frame "ftmp" from the stack, copy contents of "f" into "ftmp" and insert "ftmp" into the beginning of the fifo (i.e. perform "copy-on-insert"). The size of "ftmp" is also checked and set to target_size, if necessary. If wait is set to true, will wait until there are frames available in the stack. </p>
<ul>
<li></li>
</ul>

<p>Reimplemented in <a class="el" href="classOpenGLFrameFifo.html#a71356c2eeea511481876d53675855a6c">OpenGLFrameFifo</a>, and <a class="el" href="classLiveFifo.html#af1040c40ceafed60fe2d60a5f24baa9b">LiveFifo</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFrameFifo_a01765bd79b616a2425ba84d94a15d737_cgraph.png" border="0" usemap="#classFrameFifo_a01765bd79b616a2425ba84d94a15d737_cgraph" alt=""/></div>
<map name="classFrameFifo_a01765bd79b616a2425ba84d94a15d737_cgraph" id="classFrameFifo_a01765bd79b616a2425ba84d94a15d737_cgraph">
<area shape="rect" id="node2" href="classFrameFifo.html#a094d025e259aef84c8d3d4b76c0076eb" title="Recycle all frames from fifo back to stack (make a &quot;flush&quot;) " alt="" coords="211,5,358,32"/>
<area shape="rect" id="node3" href="tools_8h.html#a69a8d8c398f99883b5c1a22173d6b12f" title="Utility function: returns current unix epoch timestamp in milliseconds. " alt="" coords="201,56,368,83"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/sampsa/C/valkka/include/<a class="el" href="queues_8h_source.html">queues.h</a></li>
<li>/home/sampsa/C/valkka/src/<a class="el" href="queues_8cpp.html">queues.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
